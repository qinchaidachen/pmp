# 实现计划

- [x] 1. 创建项目结构和类型定义
  - 创建组件目录结构（components/TaskBoard）
  - 定义 TypeScript 类型接口（Task, Member, BoardConfig, ColorScheme 等）
  - 配置 TypeScript 编译选项
  - 安装必要依赖（dayjs, react/vue）
  - _需求: 1.1, 6.1, 6.2_

- [x] 2. 实现 LayoutEngine 布局引擎
  - [x] 2.1 实现日期范围生成功能
    - 编写 generateDateRange 方法，支持包含/排除周末
    - 处理日期边界情况
    - _需求: 1.3, 4.1, 4.4_
  - [x] 2.2 实现周分组逻辑
    - 编写 groupDatesByWeek 方法
    - 支持周一/周日作为起始日
    - 生成周标题（"第一周"、"第二周"）
    - _需求: 4.1, 4.2, 4.3, 4.4_
  - [x] 2.3 实现任务跨列计算
    - 编写 calculateTaskSpan 方法
    - 计算任务在日期范围内的起始索引和跨列数
    - 处理任务超出日期范围的情况
    - _需求: 2.1, 2.2_
  - [x] 2.4 实现单元格矩阵构建
    - 编写 buildMatrix 方法
    - 初始化成员-日期二维矩阵
    - 填充任务数据并标记占用的单元格
    - _需求: 1.1, 1.4, 2.1_

- [x] 3. 实现颜色和样式工具函数
  - [x] 3.1 实现颜色对比度计算
    - 编写 hexToRgb 颜色转换函数
    - 编写 getContrastColor 函数计算文本颜色
    - 确保文本在任何背景下可读
    - _需求: 3.4_
  - [x] 3.2 定义默认颜色方案
    - 创建 DEFAULT_COLOR_SCHEME 常量
    - 实现 5 种任务状态颜色
    - _需求: 3.1, 3.2_

- [x] 4. 实现数据验证功能
  - 编写 validateTaskData 函数
  - 验证任务 id、memberId、日期范围等必填字段
  - 返回验证结果和错误信息
  - _需求: 6.4_

- [x] 5. 实现 TaskCell 任务单元格组件
  - [x] 5.1 创建 TaskCell 基础组件
    - 实现 TaskCellProps 接口
    - 渲染任务内容或空单元格
    - 应用跨列样式（colSpan 或 grid-column）
    - _需求: 1.4, 2.2, 2.3_
  - [x] 5.2 实现任务状态颜色应用
    - 根据 task.status 或 task.color 设置背景色
    - 使用 getContrastColor 设置文本颜色
    - 添加视觉边界样式
    - _需求: 3.1, 3.2, 3.3, 2.4_
  - [x] 5.3 实现文本截断和 hover 提示
    - 文本过长时使用 CSS 截断
    - 添加 title 属性显示完整内容
    - _需求: 7.2_
  - [x] 5.4 实现点击事件处理
    - 添加 onClick 事件处理
    - 触发 onTaskClick 回调
    - _需求: 7.1_

- [x] 6. 实现 TaskBoardHeader 表头组件
  - [x] 6.1 创建 WeekHeader 周标题组件
    - 渲染周次标题（"第一周"、"第二周"）
    - 计算每周的跨列数
    - 添加视觉分隔符样式
    - _需求: 4.1, 4.3_
  - [x] 6.2 创建 DateHeader 日期行组件
    - 渲染日期和星期信息
    - 格式化日期显示（如 "2/1 周三"）
    - _需求: 1.3, 4.2_
  - [x] 6.3 实现固定表头样式
    - 使用 position: sticky 固定表头
    - 设置合适的 z-index
    - _需求: 5.3_

- [x] 7. 实现 MemberRow 成员行组件
  - [x] 7.1 创建 MemberCell 成员信息单元格
    - 渲染成员岗位名称
    - 实现固定首列样式（position: sticky）
    - _需求: 1.2, 5.2_
  - [x] 7.2 渲染成员的任务单元格
    - 遍历日期范围渲染 TaskCell
    - 跳过被占用的单元格（跨日任务）
    - _需求: 1.4, 2.1, 2.2_

- [x] 8. 实现 TaskBoardBody 表体组件
  - 遍历成员列表渲染 MemberRow
  - 传递单元格矩阵数据
  - 传递事件回调函数
  - _需求: 1.1, 1.2_

- [x] 9. 实现 TaskBoard 主组件
  - [x] 9.1 实现组件状态管理
    - 使用 useState/useMemo 管理内部状态
    - 初始化 LayoutEngine 实例
    - 计算 dateRange、weekGroups、cellMatrix
    - _需求: 6.1, 6.3_
  - [x] 9.2 实现数据验证和错误处理
    - 在组件挂载时验证输入数据
    - 显示验证错误信息
    - _需求: 6.4_
  - [x] 9.3 组装子组件
    - 渲染 TaskBoardHeader
    - 渲染 TaskBoardBody
    - 传递配置和回调函数
    - _需求: 1.1, 1.2, 1.3_
  - [x] 9.4 实现事件回调处理
    - 处理 onTaskClick 事件
    - 处理 onCellClick 事件
    - 处理 onTaskUpdate 事件（编辑模式）
    - _需求: 7.1, 7.4_

- [x] 10. 实现 CSS 样式
  - [x] 10.1 创建基础表格样式
    - 使用 CSS Grid 布局
    - 定义网格列宽（成员列 150px，日期列 80px）
    - 添加边框和间距
    - _需求: 1.1_
  - [x] 10.2 实现固定表头和首列
    - 使用 position: sticky 固定表头
    - 使用 position: sticky 固定首列
    - 设置正确的 z-index 层级
    - _需求: 5.2, 5.3_
  - [x] 10.3 实现滚动样式
    - 添加横向和纵向滚动
    - 设置最大高度（如 80vh）
    - 优化滚动条样式
    - _需求: 5.1_
  - [x] 10.4 实现响应式样式
    - 添加移动端媒体查询
    - 调整列宽和字体大小
    - 确保移动设备可读性
    - _需求: 5.4_
  - [x] 10.5 实现交互样式
    - 添加 hover 效果
    - 添加点击反馈
    - 添加过渡动画
    - _需求: 7.1, 7.2_

- [x] 11. 实现 TaskTooltip 提示框组件（可选）
  - 创建悬浮提示框组件
  - 显示任务完整信息和描述
  - 实现定位逻辑
  - _需求: 7.2_

- [x] 12. 实现编辑模式功能（可选）
  - 添加编辑模式状态管理
  - 实现单元格内联编辑
  - 触发 onTaskUpdate 回调
  - _需求: 7.3, 7.4_

- [x] 13. 创建示例和文档
  - [x] 13.1 创建基础使用示例
    - 编写示例数据（members, tasks, config）
    - 创建示例页面展示组件
    - _需求: 所有_
  - [x] 13.2 创建高级功能示例
    - 展示编辑模式
    - 展示自定义颜色
    - 展示事件回调
    - _需求: 3.1, 7.1, 7.3_
  - [x] 13.3 编写组件 API 文档
    - 文档化所有 Props 接口
    - 文档化事件回调
    - 提供配置示例
    - _需求: 所有_

- [-] 14. 性能优化
  - [x] 14.1 实现组件 memoization
    - 使用 React.memo 包装 TaskCell
    - 使用 useMemo 缓存计算结果
    - 优化渲染性能
    - _需求: 6.3_
  - [x] 14.2 实现虚拟滚动（可选）
    - 集成 react-window 或自定义虚拟滚动
    - 只渲染可见区域的单元格
    - 优化大数据量场景
    - _需求: 6.3_

- [x] 15. 实现错误边界组件
  - 创建 TaskBoardErrorBoundary 组件
  - 捕获渲染错误
  - 显示友好的错误信息
  - _需求: 6.4_

- [x] 16. 添加可访问性支持
  - [x] 16.1 添加 ARIA 属性
    - 为表格添加 role="grid"
    - 为单元格添加 aria-label
    - 为状态颜色添加文本说明
    - _需求: 所有_
  - [x] 16.2 实现键盘导航
    - 支持 Tab 键导航
    - 支持 Enter 键交互
    - 支持方向键移动
    - _需求: 7.1_
